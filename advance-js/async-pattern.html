<!DOCTYPE html>
<html>
<head>
	<title>Async Pattern</title>
</head>
<body>
	<h1>Please open console and see the output</h1>

	<script src="jquery.min.js" type="text/javascript"></script>
	<script type="text/javascript">
		//async patterns generators
		function* gen() {
			console.log("hello");
			yield null;
			console.log("world");
		}
			var it = gen();
			it.next();
			it.next();

		function coroutine(g) {
			var it = g();
			return function(){
				return it.next.apply(it, arguments);
			};
		}
		var run = coroutine(function* (){
			var x = 1 + (yield null);
			var y = 1 + (yield null);
			yield (x + y);
		});
			run();
			run(11);
			console.log("meaning of life: " + run(33).value);

		function getData(d) {
			setTimeout(function () { run(d);
			},1500);
		}
		var run = coroutine(function* () {
			var x = 1 + (yield getData(11));
			var y = 1 + (yield getData(22));
			var ans = (yield getData("your age is : " + (x+y)
			));
			console.log(ans);
		});
		run();

		//promises : continuation events
		var wait = jQuery.Deferred();
		var p = wait.promise();

		p.done(function (value) {
			console.log("promise output value " + value);
		});
		setTimeout(function(){
			wait.resolve(Math.random());
		},1700);

		function waitForN(an) {
			var c = $.Deferred();
			setTimeout(c.resolve, an);
			return c.promise();
		}
		waitForN(1800).then(function (){
			console.log("java script");
			return waitForN(2000);
		}).then(function(){
			console.log("seriously... ?");
		});
	</script>
</body>
</html>